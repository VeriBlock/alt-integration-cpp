if(TESTING)
    message(STATUS "Adding gtest")
    set(gtest_hide_internal_symbols TRUE CACHE BOOL "hide internal gtest symbols")
    set(INSTALL_GTEST FALSE CACHE BOOL "install gtest")
    set(BUILD_GMOCK ON CACHE BOOL "build gmock")
    set(BUILD_GTEST ON CACHE BOOL "build gtest")
    if(SHARED)
        set(gtest_force_shared_crt ON CACHE BOOL "force shared CRT")
    else()
        set(gtest_force_shared_crt OFF CACHE BOOL "force shared CRT")
        set(BUILD_SHARED_LIBS OFF CACHE BOOL "build static libs")
    endif()

    add_subdirectory(${CMAKE_SOURCE_DIR}/deps/googletest EXCLUDE_FROM_ALL)
    disable_clang_tidy(gtest)
    disable_clang_tidy(gtest_main)
    disable_clang_tidy(gmock)
    disable_clang_tidy(gmock_main)
endif()
